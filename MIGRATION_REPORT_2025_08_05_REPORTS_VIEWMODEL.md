# –û—Ç—á–µ—Ç –æ –º–∏–≥—Ä–∞—Ü–∏–∏ ReportsViewModel –Ω–∞ Clean Architecture

**–î–∞—Ç–∞:** 5 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~3 —á–∞—Å–∞  

## üéØ –¶–µ–ª—å
–ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `ReportsViewModel` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `PostStore` –Ω–∞ Clean Architecture —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Use Cases –∏ Dependency Injection.

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ ReportsState
- ‚úÖ –°–æ–∑–¥–∞–Ω `ReportsState.swift` —Å –ø–æ–ª–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–ª—è —ç–∫—Ä–∞–Ω–∞ –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –¥–ª—è –¥–∞–Ω–Ω—ã—Ö: `regularReports`, `customReports`, `externalReports`, `goodTags`, `badTags`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –¥–ª—è UI —Å–æ—Å—Ç–æ—è–Ω–∏—è: `isSelectionMode`, `selectedLocalReportIDs`, `showEvaluationSheet`, `evaluatingPost`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è UI –ª–æ–≥–∏–∫–∏: `hasRegularPosts`, `selectedReportsCount`, `canDeleteReports` –∏ –¥—Ä.

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ ReportsEvent
- ‚úÖ –°–æ–∑–¥–∞–Ω `ReportsEvent` –≤ `ReportsState.swift`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: `loadReports`, `refreshReports`, `loadTags`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–æ–±—ã—Ç–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞: `toggleSelectionMode`, `toggleSelection`, `selectAllRegularReports`, `selectAllCustomReports`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–æ–±—ã—Ç–∏—è –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π: `deleteSelectedReports`, `startEvaluation`, `completeEvaluation`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–æ–±—ã—Ç–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫: `updateReevaluationSettings`

### 3. –°–æ–∑–¥–∞–Ω–∏–µ ReportsViewModelNew
- ‚úÖ –°–æ–∑–¥–∞–Ω `ReportsViewModelNew.swift` —Å Clean Architecture
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Use Cases –≤–º–µ—Å—Ç–æ PostStore: `GetReportsUseCase`, `DeleteReportUseCase`, `UpdateReportUseCase`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `TagRepositoryProtocol` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–≥–∞–º–∏
- ‚úÖ –°–ª–µ–¥—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—É State/Event —Å `BaseViewModel<ReportsState, ReportsEvent>`
- ‚úÖ –†–µ–∞–ª–∏–∑—É–µ—Ç `LoadableViewModel` –ø—Ä–æ—Ç–æ–∫–æ–ª
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç–∞—Ä–æ–≥–æ ViewModel:
  - –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ (–æ–±—ã—á–Ω—ã–µ, –∫–∞—Å—Ç–æ–º–Ω—ã–µ, –≤–Ω–µ—à–Ω–∏–µ)
  - –í—ã–±–æ—Ä –æ—Ç—á–µ—Ç–æ–≤ (–æ–¥–∏–Ω–æ—á–Ω—ã–π, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, "–≤—ã–±—Ä–∞—Ç—å –≤—Å–µ")
  - –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
  - –û—Ü–µ–Ω–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∏

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è `TagRepository` –≤ `DependencyContainer`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (`userDefaults: .standard`)
- ‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã

### 5. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω `ReportsViewModelNewTests.swift` —Å 15 —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:
  - –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞)
  - –í—ã–±–æ—Ä –æ—Ç—á–µ—Ç–æ–≤ (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞, –≤—ã–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
  - –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
  - –û—Ü–µ–Ω–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
  - –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
  - –ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã Mock –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥**: `ReportsViewModel` ‚Üí `PostStore` ‚Üí `UserDefaults`
- **–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥**: `ReportsViewModelNew` ‚Üí `Use Cases` ‚Üí `Repositories` ‚Üí `Data Sources`

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Use Cases
- `GetReportsUseCase` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤
- `DeleteReportUseCase` - –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
- `UpdateReportUseCase` - –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ (–æ—Ü–µ–Ω–∫–∞)

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Repositories
- `TagRepositoryProtocol` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–≥–∞–º–∏

### –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —Å–æ–±—ã—Ç–∏—è
- **–°–æ—Å—Ç–æ—è–Ω–∏–µ**: 15 –ø–æ–ª–µ–π + 10 –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤
- **–°–æ–±—ã—Ç–∏—è**: 12 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –£—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- –ü—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã
- –ù–æ–≤—ã–π ViewModel –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (15 —Ç–µ—Å—Ç–æ–≤)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å—Ç–∞—Ä–æ–≥–æ ViewModel

### üìà –£–ª—É—á—à–µ–Ω–∏—è
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: ViewModel —Ç–µ–ø–µ—Ä—å –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Mock –æ–±—ä–µ–∫—Ç–æ–≤
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: –ö–∞–∂–¥—ã–π Use Case –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –æ–ø–µ—Ä–∞—Ü–∏—é
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π
- **–°–æ—Å—Ç–æ—è–Ω–∏–µ**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Å–æ–±—ã—Ç–∏–π

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –°–æ–∑–¥–∞—Ç—å ReportsViewNew
- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π View, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π `ReportsViewModelNew`
- –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ UI –ª–æ–≥–∏–∫—É –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ `ReportsView`
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–æ–≤—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ —Å–æ–±—ã—Ç–∏–π

### 2. –ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–π ReportsView
- –û–±–Ω–æ–≤–∏—Ç—å `ReportsCoordinator` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ View
- –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π `ReportsView` –∏ `ReportsViewModel`

### 3. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
- –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `SettingsViewModel`
- –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `TagManagerViewModel`

## üìù –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

### –°–æ–∑–¥–∞–Ω–æ
- `LazyBones/Presentation/ViewModels/States/ReportsState.swift`
- `LazyBones/Presentation/ViewModels/ReportsViewModelNew.swift`
- `Tests/Presentation/ViewModels/ReportsViewModelNewTests.swift`

### –ò–∑–º–µ–Ω–µ–Ω–æ
- `LazyBones/Core/Common/Utils/DependencyContainer.swift` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è TagRepository

### –°—Ç–∞—Ç—É—Å
- ‚úÖ `ReportsViewModelNew` - –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚ùå `ReportsViewModel` (—Å—Ç–∞—Ä—ã–π) - –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è ReportsViewNew
- ‚ùå `ReportsView` - —Ç—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –Ω–æ–≤—ã–π ViewModel

---

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏: 80% –∑–∞–≤–µ—Ä—à–µ–Ω–æ** üéâ 